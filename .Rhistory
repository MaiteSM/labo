stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g11 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtransferencias_recibidas),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g12 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtransferencias_emitidas),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g13 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ccuenta_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g14 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcuenta_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g15 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_visa_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g16 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtarjeta_visa_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g17 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_master_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g18 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mttarjeta_master_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g19 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=cpagodeservicios),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g20 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpagodeservicios),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g21 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=cpagomiscuentas),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g22 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpagomiscuentas),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# MOVIMIENTO EN CUENTAS: ctrx_quarter
g23 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctrx_quarter),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# ACREDITACION HABERES: cpayroll_trx, mpayroll, mpayroll2, cpayroll2_trx
g24 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=cpayroll_trx),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g25 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpayroll),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g26 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpayroll2),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g27 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=cpayroll2_trx),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# TARJETA VISA: Visa_msaldototal, Visa_msaldopesos, mtarjeta_visa_consumo,
#  Visa_mconsumospesos, ctarjeta_visa_trx, Visa_mconsumototal,
#  Visa_cconsumos, Visa_mpagospesos
g28 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_msaldototal),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g29 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_msaldopesos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g30 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtarjeta_visa_consumo),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g31 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_mconsumospesos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g32 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_visa_trx),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g33 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_mconsumototal),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g34 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_cconsumos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g35 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_mpagospesos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# Descuentos: ccajeros_propios_descuentos, mcajeros_propios_descuentos,
#   ctarjeta_visa_descuentos, mtarjeta_visa_descuentos, ctarjeta_master_descuentos,
#   mtarjeta_master_descuentos
g36 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ccajeros_propios_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g37 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcajeros_propios_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g38 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_visa_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g39 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtarjeta_visa_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g40 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_master_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g41 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtarjeta_master_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
return(g1, g2, g3, g4, g5, g6, g7, g8, g9, g10, g11, g12, g13, g14,
g15, g16, g17, g18, g19, g20, g21, g22, g23, g24, g25, g26,
g27, g28, g29, g30, g31, g32, g33, g34, g35, g36, g37, g38, g39, g40, g41)
}
graficos(clus3)
graficos <- function(dataset) {
medias3 <- dataset[, lapply(.SD, function(x){mean(x)}), by = cluster2]
# Ejes a analizar
# RENTABILIDAD: mrentabilidad_annual, mrentabilidad, mpasivos_margen, mactivos_margen
g1 <-ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mrentabilidad_annual),
stat="identity", fill="orange", alpha=0.7)+
#scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g2 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mrentabilidad),
stat="identity", fill="orange", alpha=0.7)+
#scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g3 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpasivos_margen),
stat="identity", fill="orange", alpha=0.7)+
#scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g4 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mactivos_margen),
stat="identity", fill="orange", alpha=0.7)+
#scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# COMISIONES: mcomisiones, mcomisiones_mantenimiento, mcomisiones_otras,
g5 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcomisiones),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g6 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcomisiones_otras),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g7 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcomisiones_mantenimiento),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# SALDO en cuenta: mcuentas_saldo, mcaja_ahorro
g8 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcuentas_saldo),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g9 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcaja_ahorro),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# SERVICIOS DIGITALES: chomebanking_trx, mtransferencias_recibidas, mtransferencias_emitidas,
#  ccuenta_debitos_automaticos, mcuenta_debitos_automaticos, ctarjeta_visa_debitos_automaticos,
#  mtarjeta_visa_debitos_automaticos, ctarjeta_master_debitos_automaticos,
#  mttarjeta_master_debitos_automaticos, cpagodeservicios, mpagodeservicios
#  cpagomiscuentas, mpagomiscuentas
g10 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=chomebanking_trx),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g11 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtransferencias_recibidas),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g12 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtransferencias_emitidas),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g13 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ccuenta_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g14 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcuenta_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g15 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_visa_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g16 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtarjeta_visa_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g17 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_master_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g18 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mttarjeta_master_debitos_automaticos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g19 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=cpagodeservicios),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g20 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpagodeservicios),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g21 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=cpagomiscuentas),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g22 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpagomiscuentas),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# MOVIMIENTO EN CUENTAS: ctrx_quarter
g23 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctrx_quarter),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# ACREDITACION HABERES: cpayroll_trx, mpayroll, mpayroll2, cpayroll2_trx
g24 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=cpayroll_trx),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g25 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpayroll),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g26 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mpayroll2),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g27 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=cpayroll2_trx),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# TARJETA VISA: Visa_msaldototal, Visa_msaldopesos, mtarjeta_visa_consumo,
#  Visa_mconsumospesos, ctarjeta_visa_trx, Visa_mconsumototal,
#  Visa_cconsumos, Visa_mpagospesos
g28 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_msaldototal),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g29 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_msaldopesos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g30 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtarjeta_visa_consumo),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g31 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_mconsumospesos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g32 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_visa_trx),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g33 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_mconsumototal),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g34 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_cconsumos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g35 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=Visa_mpagospesos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
# Descuentos: ccajeros_propios_descuentos, mcajeros_propios_descuentos,
#   ctarjeta_visa_descuentos, mtarjeta_visa_descuentos, ctarjeta_master_descuentos,
#   mtarjeta_master_descuentos
g36 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ccajeros_propios_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g37 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mcajeros_propios_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g38 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_visa_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g39 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtarjeta_visa_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g40 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=ctarjeta_master_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
g41 <- ggplot(medias3) +
geom_bar( aes(x=cluster2, y=mtarjeta_master_descuentos),
stat="identity", fill="orange", alpha=0.7)+
scale_x_continuous(breaks = 1:10, labels = 1:10) +
coord_flip() +
theme_classic()
return(g1)
return(g2)
return(g3)
return(g4)
return(g5)
return(g6)
return(g7)
return(g8)
return(g9)
return(g10)
return(g11)
return(g12)
return(g13)
return(g14)
return(g15)
return(g16)
return(g17)
return(g18)
return(g19)
return(g20)
return(g21)
return(g22)
return(g23)
return(g24)
return(g25)
return(g26)
return(g27)
return(g28)
return(g29)
return(g30)
return(g31)
return(g32)
return(g33)
return(g34)
return(g35)
return(g36)
return(g37)
return(g38)
return(g39)
return(g40)
return(g41)
}
clus3  <- fread("./labo/exp/ST4614/cluster_de_bajas3.txt")
graficos(clus3)
