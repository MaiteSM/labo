dataset1  <- fread("./labo/src/FeatureEngineering/algunos_ids.txt")
getwd()
library(data.table)
dataset1  <- fread("./src/FeatureEngineering/algunos_ids.txt")
View(dataset1)
library(tidyverse)
dataset1 %>% group_by(numero_de_cliente) %>%
summarise(n = n())
View(dataset1)
View(dataset1)
m1 <- lm(ctrx_quarter ~ foto_mes,dataset1)
m1$coefficients
m1$model
m1$effects
table(dataset1$clase_ternaria)
runif(1)
dataset <- dataset [clase_ternaria == "CONTINUA", runif(1)]
riesgo <- function(dataset, campos){
dataset[, riesgo := 0]
# Calculo los límites
for (vble in campos) {
paste0(vble,"_lim") <- dataset[clase_ternaria == "BAJA+2",
quantile(vble, 0.75)]
# Agrego campos
dataset[, ifelse(vble <= paste0(vble,"_lim"), riesgo := riesgo + 1)]
}
ReportarCampos( dataset )
}
ReportarCampos  <- function( dataset )
{
cat( "La cantidad de campos es ", ncol(dataset) , "\n" )
}
riesgo(dataset1, c(ctrx_quarter))
riesgo(dataset1, c("ctrx_quarter"))
dataset <- dataset1
dataset[, riesgo := 0]
campos <- c("ctrx_quarter")
# Calculo los límites
for (vble in campos) {
paste0(vble,"_lim") <- dataset[clase_ternaria == "BAJA+2",
quantile(vble, 0.75)]
# Agrego campos
dataset[, ifelse(vble <= paste0(vble,"_lim"), riesgo := riesgo + 1)]
}
for (vble in campos) {
paste0(vble,"_lim") <- dataset[clase_ternaria == "BAJA+2",
quantile(vble, 0.75)]}
for (vble in campos) { cat(vble)}
for (vble in campos) {
paste0(vble,"_lim")}
for (vble in campos) {
cat(paste0(vble,"_lim"))}
dataset[clase_ternaria == "BAJA+2",
quantile(campos, 0.75)]
dataset[clase_ternaria == "BAJA+2",
quantile(ctrx_quarter, 0.75)
]
a<- dataset[clase_ternaria == "BAJA+2",
quantile(ctrx_quarter, 0.75)]
a
a+5
a/5
vbles <- "ctrx_quarter"
paste0(vble,"_lim")
paste0(vble,"_lim") <- 5
for (i in 1:length(campos)){
cortes[i,1] <- paste0(campos[i],"_lim")
}
cortes <- NA
for (i in 1:length(campos)){
cortes[i,1] <- paste0(campos[i],"_lim")
}
campos[1]
cortes <- matrix(NA)
for (i in 1:length(campos)){
cortes[i,1] <- paste0(campos[i],"_lim")
}
for (i in 1:length(campos)){
cortes[i,1] <- paste0(campos[i],"_lim")
cortes[i,2] <- dataset[clase_ternaria == "BAJA+2",
quantile(campos[i], 0.75)]
}
dataset[clase_ternaria == "BAJA+2",
quantile(campos[1], 0.75)]
dataset[clase_ternaria == "BAJA+2",
quantile(ctrx_quarter, 0.75)]
campos[1]
library(randomForest)
library(data.table)
getwd()
ids <- fread("./src/FeatureEngineering/algunos_ids.txt")
View(ids)
library(tidyverse)
clientes <- unique(dataset$numero_de_cliente)
productos <- dataset %>% group_by(numero_de_cliente) %>%
summarise(max = max(cproductos), min = min(cproductos)) %>%
select(numero_de_cliente, max, min, foto_mes)
productos <- dataset %>% group_by(numero_de_cliente, foto_mes) %>%
summarise(max = max(cproductos), min = min(cproductos)) %>%
select(numero_de_cliente, max, min, foto_mes)
View(productos)
productos <- dataset %>% select(numero_de_cliente, cproductos, foto_mes)
productos <- dataset %>% select(numero_de_cliente, cproductos, foto_mes)
getwd()
#Establezco el Working Directory
setwd( "d:/Datos User/Desktop/Datos esc/MCD/12 Laboratorio de Implementacion/LII/" )
#lectura de los datasets
data  <- fread("./datasets/paquete_premium_202011.csv")
library(data.table)
#lectura de los datasets
data  <- fread("./datasets/paquete_premium_202011.csv")
table(dataset[cpayroll_trx == 0, mpayroll])
table(dataset[cpayroll_trx == 0, mpayroll2])
View(dataset)
View(ids)
dataset[ foto_mes==201806,
tcallcenter]
library(tidyverse)
dataset %>% filter(foto_mes == 201806) %>% select(numero_de_cliente, tcallcenter)
dataset %>% filter(foto_mes == 201806 | foto_mes == 201805 | foto_mes == 201807) %>%
select(numero_de_cliente, tcallcenter) %>%
arrange(numero_de_cliente, foto_mes)
dataset %>% filter(foto_mes == 201806 | foto_mes == 201805 | foto_mes == 201807) %>%
select(numero_de_cliente, tcallcenter) %>%
arrange(c(numero_de_cliente, foto_mes))
dataset %>% filter(foto_mes == 201806 | foto_mes == 201805 | foto_mes == 201807) %>%
select(numero_de_cliente, tcallcenter) %>%
arrange(numero_de_cliente)
dataset %>% filter(foto_mes == 201806 | foto_mes == 201805 | foto_mes == 201807) %>%
select(numero_de_cliente, foto_mes, tcallcenter) %>%
arrange(numero_de_cliente, foto_mes)
dataset[, ifelse(cextraccion_autoservicio == 0, mextraccion_autoservicio = NA)]
dataset[, ifelse(ctarjeta_master == 0, Master_madelantopesos = NA)]
library(tidyverse)
dataset1 <- dataset1 %>% arrange(desc(numero_de_cliente))
if (datase1t[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso = 1]
} else {dataset1[i, reingreso = 0]}
dataset1 <- dataset1 %>% arrange(desc(numero_de_cliente))
for (i in 2:nrow(dataset1)){
if (datase1t[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso = 1]
} else {dataset1[i, reingreso = 0]}
}
for (i in 2:nrow(dataset1)){
if (dataset1[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso = 1]
} else {dataset1[i, reingreso = 0]}
}
dataset1[2, cliente_antiguedad]
View(dataset1)
dataset1[2, cliente_antiguedad]
dataset[2, "cliente_antiguedad"]
View(dataset1)
dataset[2, cliente_antiguedad]
dataset[2, 5]
cliente <- dataset %>% group_by(numero_de_cliente) %>% select(numero_de_cliente)
cliente
cliente <- dataset %>% group_by(numero_de_cliente) %>%
summarise( n = 1 ) %>% select(numero_de_cliente)
dataset1[2, numero_de_cliente]
dataset1[2, "numero_de_cliente"]
for (i in 2:nrow(dataset1)){
if (dataset1[i, "cliente_antiguedad"] < dataset1[i-1, "cliente_antiguedad"]) {
dataset1[i, reingreso = 1]
} else {dataset1[i, reingreso = 0]}
}
for (i in 2:nrow(dataset1)){
if (dataset1[i, "cliente_antiguedad"] < dataset1[i-1, "cliente_antiguedad"]) {
dataset1[i, reingreso := 1]
} else {dataset1[i, reingreso := 0]}
}
library(data.table)
dataset1[2, numero_de_cliente]
for (i in 2:nrow(dataset1)){
if (dataset1[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso := 1]
} else {dataset1[i, reingreso := 0]}
}
View(dataset1)
dataset1 <- dataset1 %>% arrange(desc(numero_de_cliente))
for (i in 2:nrow(dataset1)){
if (dataset1[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso := 1] }
}
dataset1[, reingreso := 0]
for (i in 2:nrow(dataset1)){
if (dataset1[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso := 1] }
}
table(dataset1$reingreso)
dataset1 %>% group_by(numero_de_cliente, foto_mes, cliente_antiguedad, reingreso) %>%
arrange(desc(numero_de_cliente))
dataset1 %>% group_by(numero_de_cliente, foto_mes, cliente_antiguedad, reingreso) %>%
arrange(desc(numero_de_cliente)) %>% summarise(n = 1)
dataset1 %>% group_by(numero_de_cliente, foto_mes, cliente_antiguedad, reingreso) %>%
arrange(numero_de_cliente) %>% summarise(n = 1)
dataset1 <- dataset1 %>% arrange(desc(numero_de_cliente))
dataset1[, reingreso := 0]
for (i in 2:nrow(dataset1)){
if (dataset1[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso := 1] }
}
dataset1 %>% group_by(numero_de_cliente, foto_mes, cliente_antiguedad, reingreso) %>%
arrange(numero_de_cliente) %>% summarise(n = 1)
dataset1 <- dataset1 %>% arrange(numero_de_cliente)
dataset1 <- dataset1 %>% arrange(numero_de_cliente)
dataset1[, reingreso := 0]
for (i in 2:nrow(dataset1)){
if (dataset1[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso := 1] }
}
dataset1 %>% group_by(numero_de_cliente, foto_mes, cliente_antiguedad, reingreso) %>%
arrange(numero_de_cliente) %>% summarise(n = 1)
for (i in 1:nrow(dataset1)){
if (dataset[i, reingreso] == 1) {
num <- dataset[i, numero_de_cliente]
}
for (i in num) {
dataset[i, reingreso] = 1
}
}
for (i in 1:nrow(dataset1)){
if (dataset1[i, reingreso] == 1) {
num <- dataset1[i, numero_de_cliente]
}
for (i in num) {
dataset1[i, reingreso] = 1
}
}
dataset1 <- dataset1 %>% arrange(numero_de_cliente)
dataset1[, reingreso := 0]
for (i in 2:nrow(dataset1)){
if (dataset1[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso := 1] }
}
for (i in 1:nrow(dataset1)){
if (dataset1[i, reingreso] == 1) {
num <- dataset1[i, numero_de_cliente]
}
for (j in i:nrow(dataset1)) {
if (j == num){
dataset1[j, reingreso] = 1
}
}
}
for (i in 1:nrow(dataset1)){
if (dataset1[i, reingreso] == 1) {
num <- dataset1[i, numero_de_cliente]
}
for (j in i:nrow(dataset1)) {
if (j = num){
dataset1[j, reingreso] = 1
}
}
}
for (i in 1:nrow(dataset1)){
if (dataset1[i, reingreso] == 1) {
num <- dataset1[i, numero_de_cliente]
}
for (j in i:nrow(dataset1)) {
if (dataset1[j, numero_de_cliente] == num){
dataset1[j, reingreso] = 1
}
}
}
dataset1 <- dataset1 %>% arrange(numero_de_cliente)
dataset1[, reingreso := 0]
for (i in 2:nrow(dataset1)){
if (dataset1[i, cliente_antiguedad] < dataset1[i-1, cliente_antiguedad]) {
dataset1[i, reingreso := 1] }
}
for (i in 1:nrow(dataset1)){
if (dataset1[i, reingreso] == 1) {
num <- dataset1[i, numero_de_cliente]
}
for (j in i:nrow(dataset1)) {
if (dataset1[j, numero_de_cliente] == num){
dataset1[j, reingreso] = 1
}
}
}
